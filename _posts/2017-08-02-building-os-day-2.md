---
layout: post
title: [Building OS] Day 2
---

# 64비트 멀티코어 OS 만들기 2
<br>

이번 포스트에서는 64비트 프로세서에 대해 알아보도록 하겠다.

인텔 64비트 호환 프로세서(x86_64 프로세서)에서는 크게 다섯 가지 운영 모드가 있다.

운영 모드 | 설명
------- | -------
리얼 모드 | 프로세서의 초기 상태(16비트로 동작하며 8086 프로세서와 호환되는 모드)
보호 모드 | 32비트로 동작하며 세그먼트, 페이징, 보호, 멀티태스킹 등의 기능 제공
IA-32e 모드 | 32비트 호환 모드와 64비트 모드의 두 가지 서브 모드로 구성
시스템 관리 모드 | 전원 관리나 하드웨어 제어 같은 특수 기능을 제공하는 모드
가상 8086 모드 | 보호 모두 내부에서 가상의 환경을 설정하여 리얼 모드처럼 동작하는 모드

> 참고로, 64비트를 지원하는 IA-32e 모드는 AMD에서 Long Mode로 표기한다.

64비트 OS가 반드시 지원해야 하는 세 가지 모드는 리얼 모드, 보호 모드, IA-32e 모드(*64비트 서브 모드*)이다. 시스템 관리 모드나 가상 8086 모드는 특수한 상황에서 사용되므로 OS에서 해당 기능을 사용하지 않는다면 구현하지 않아도 된다.

<br>
## 리얼 모드
<br>

프로세서가 어떤 상태 또는 모드에 있든 전원이 켜지거나 리셋되면 프로세서는 리얼 모드로 진입한다. 리얼 모드는 BIOS(*Basic Input Ouput System*)의 여러 기능을 사용할 수 있으며, BIOS는 디스크 읽기 및 쓰기 기능, 그래픽 모드 전환 기능 등 제공한다. 리얼 모드의 역할은 **OS 이미지를 디스크에서 메모리로 복사하여 보호 모드로 변경하는 것**
이지만 대부분 어셈블리어로 처리해야 한다.

<br>
## 보호 모드
<br>

보호 모드는 IA-32e 모드로 전환하는 과정에서 반드시 거쳐야 하는 모드이다. 32비트 윈도우나 리눅스 OS가 동작하는 기본 모드이며, 최대 4G(2^32) 주소 공간을 제공한다. OS의 필수 기능으로 여겨지는 보호, 멀티태스킹, 세그먼테이션, 페이징 등의 기능을 하드웨어적으로 지원한다.
